---
layout:     post
title:      "Google Plus æ–‡æœ¬æå–ä¸åˆ†æ"
subtitle:   "æ•°æ®æå–ã€Bosenåˆ†è¯ã€NLTKã€TFIDFã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰"
date:       2016-10-19
author:     "T.L"
header-img: "img/post-bg-Google+.jpg"
tags:
    - ç¤¾äº¤ç½‘ç«™æ•°æ®åˆ†æ
    - ç¤¾ä¼šè®¡ç®—
---
æœ¬æ–‡æ‰€æœ‰æ•°æ®æºè‡ªgoogle+,å…¨ç¯‡å›´ç»•äº”ä¸ªæ–¹é¢æ¥è¿›è¡Œæ–‡æœ¬æå–å’Œåˆ†æï¼š

1. æ•°æ®è·å–
2. ä¸­æ–‡åˆ†è¯
3. NLTK
4. ç‰¹å¾è¯æå–
5. æ–‡æœ¬ç›¸ä¼¼åº¦ 
 
é™¤æ­¤ä¹‹å¤–æœ¬æ–‡è¿˜è®¾è®¡åˆ°æƒ…æ„Ÿè¯åˆ†æï¼Œé½æ™®å¤«å®šå¾‹ç­‰ã€‚å…¶ä»–æ–¹æ³•åƒæ‘˜è¦è‡ªåŠ¨æå–ã€æ„è§æŒ–æ˜ã€æ–‡æœ¬èšç±»ã€æ–°é—»åˆ†ç±»ç­‰å¸¸è§„æ–‡æœ¬åˆ†æå†…å®¹å¹¶ä¸é€‚åˆgoogle+çš„æ•°æ®é›†ï¼Œå› æ­¤æœ¬æ–‡æ²¡æœ‰æ¶‰åŠã€‚


## è·å–æ•°æ®
### å‡†å¤‡
google+ api è·å–æˆæƒï¼š
![](http://oc5ofszxe.bkt.clouddn.com/16-10-17/94917912.jpg)
å·¦ä¾§æ ç¬¬ä¸‰ä¸ªï¼Œç‚¹â€œå‡­æ®â€ï¼Œåˆ›å»ºapiå¯†é’¥ã€‚è¿™é‡Œç”¨apiå¯†é’¥å°±å¯ä»¥ï¼Œæ¯•ç«Ÿåªé‡‡é›†å…¬å…±æ•°æ®ä¿¡æ¯ï¼Œä¸æ˜¯ç”¨æˆ·éšç§æ•°æ®ï¼ˆéœ€è¦ç”¨æˆ·è®¤è¯ï¼‰ã€‚
![](http://oc5ofszxe.bkt.clouddn.com/16-10-17/60559851.jpg)  
Google+ [APIæ–‡æ¡£](https://developers.google.com/apis-explorer/?hl=zh_CN#p/plus/v1/)ä¸­å…·ä½“åˆ—å‡ºäº†ä½¿ç”¨æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæœ‰ä¸“é—¨çš„[APIæµè§ˆå™¨](https://developers.google.com/apis-explorer/?hl=zh_CN#p/plus/v1/plus.people.get?userId=118051310819094153327&_h=6&)å¯ä»¥æ ¹æ®æŸ¥è¯¢æ¡ä»¶å¿«é€Ÿç”ŸæˆRESTfulå¯¹åº”çš„urlåœ°å€ï¼Œå¾—åˆ°æŸ¥è¯¢ç»“æœã€‚(ä½¿ç”¨ä¹‹å‰å…ˆè®¾ç½®å³ä¸Šè§’çš„API id)
### RESTful API
ä»¥æŸ¥è¯¢æŸä¸ªç”¨æˆ·ä¸ºä¾‹ã€‚  

1. **ä½¿ç”¨APIæµè§ˆå™¨**
![](http://oc5ofszxe.bkt.clouddn.com/16-10-17/22885447.jpg)
![](http://oc5ofszxe.bkt.clouddn.com/16-10-17/72652739.jpg)
2. **ç›´æ¥æµè§ˆå™¨æŠ“å–**

```shell 
curl "https://www.googleapis.com/plus/v1/people?query=Trucy+Luce&key=$api_key"
```
>
{  
 "kind": "plus#peopleFeed",  
 "etag": "\"xw0en60W6-NurXn4VBU-CMjSPEw/ycgzanUve1bCMxC0NXlP6C4MSTM\"",  
 "selfLink": "https://www.googleapis.com/plus/v1/people?query=Trucy+Luce&key=AIzaSyB2_mjqVwT5IpqGO8wfASMdnHUuvxwQqlI",  
 "title": "Google+ People Search Results",  
 "nextPageToken": "CAESFTExMjAzMzk2OTk4NDI0NTc3MzQ3NQ",  
 "items": [  
  {  
   "kind": "plus#person",  
   "etag": "\"xw0en60W6-NurXn4VBU-CMjSPEw/xLkYpT8h4zlkDrhCUQcTzEZDl1U\"",  
   "objectType": "person",  
   "id": "112033969984245773475",  
   "displayName": "Trucy Luce",  
   "url": "https://plus.google.com/112033969984245773475",  
   "image": {  
    "url": "https://lh3.googleusercontent.com/-L0oIZ63NyHk/AAAAAAAAAAI/AAAAAAAAABg/xr0lpRdSDLM/photo.jpg?sz=50"  
   }  
  }  
 ]  
}

å…³äºjsonä¸­keyçš„è§£é‡Šï¼Œå¯ä»¥åœ¨[APIæ–‡æ¡£](https://developers.google.com/apis-explorer/?hl=zh_CN#p/plus/v1/)ä¸­æ‰¾åˆ°ã€‚  

### åˆ©ç”¨python SDK
google api for python æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯[oauth2](http://github.com/google/oauth2client)æˆæƒçš„ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç®€å•çš„[api_key](http://github.com/google/google-api-python-client)æˆæƒçš„ã€‚æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸ªï¼Œè¿™æ˜¯å…¶[APIæ–‡æ¡£](http://google.github.io/google-api-python-client/docs/epy/index.html)ã€‚è¯¥å®¢æˆ·ç«¯å·²ç»æ”¯æŒpython3ç‰ˆæœ¬ï¼Œè¿™é‡Œæœ¬æ–‡ä»£ç éƒ½ä»¥python3ä¸ºåŸºç¡€ã€‚

```python
import httplib2
import json
import apiclient.discovery # pip install google-api-python-client

Q = "Trucy Luce"
API_KEY = 'è‡ªå·±è¾“å…¥' 
service = apiclient.discovery.build('plus', 'v1', http=httplib2.Http(), developerKey=API_KEY)
people_feed = service.people().search(query=Q).execute()
print (json.dumps(people_feed['items'], indent=2))
```

buildæ–¹æ³•è¯¦ç»†æŸ¥çœ‹[ä»£ç ](http://google.github.io/google-api-python-client/docs/epy/index.html)ä¸­çš„apiè¯´æ˜ï¼Œè¿”å›ä¸€ä¸ªä¸æœåŠ¡äº¤äº’çš„èµ„æºå¯¹è±¡ï¼ˆâ€ A Resource object with methods for interacting with the service. â€œ  ï¼‰ã€‚è€Œè¿™ä¸ªå¯¹è±¡å®é™…ä¸Šæ˜¯è°ƒåŠ¨äº† build_from_documenè¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯googleapiclient.discovery.Resourceèµ„æºå¯¹è±¡ï¼Œå®šä½åˆ°è¿™ä¸ªResourceèµ„æºå¯¹è±¡ï¼Œä½†ä»”ç»†æŸ¥æ‰¾å‘ç°å…¶æ–¹æ³•ä¸‹é¢æ²¡æœ‰people()æ–¹æ³•ï¼Œä½†æœ‰ä¸‰ä¸ªç”Ÿæˆæ–¹æ³•çš„æ–¹æ³•ï¼š

1.  _add_basic_methods
2.  _add_nested_resources
3.  _add_next_methods

å®é™…ä¸Šè¿™ä¸‰ä¸ªæ–¹æ³•æ˜¯æ ¹æ®responseçš„schemå±‚æ¬¡ç»“æ„æ¥ç”Ÿæˆçš„ï¼Œè¿™é‡Œçš„ä»£ç å€¼å¾—å­¦ä¹ ã€‚
æœ€ååªæ‰“å°itemséƒ¨åˆ†ï¼Œç¨‹åºæ‰§è¡Œç»“æœå¦‚ä¸‹:

>
[  
  {  
    "etag": "\"xw0en60W6-NurXn4VBU-CMjSPEw/xLkYpT8h4zlkDrhCUQcTzEZDl1U\"",  
    "displayName": "Trucy Luce",  
    "objectType": "person",  
    "image": {  
      "url": "https://lh3.googleusercontent.com/-L0oIZ63NyHk/AAAAAAAAAAI/AAAAAAAAABg/  xr0lpRdSDLM/photo.jpg?sz=50"  
    },  
    "id": "112033969984245773475",  
    "kind": "plus#person",  
    "url": "https://plus.google.com/112033969984245773475"  
  }  
]

æ¥ä¸‹æ¥æŒ–æ˜ä¸‹æŸä¸ªç”¨æˆ·çš„è¿‘æœŸæ´»åŠ¨ï¼Œå®é™…ä¸Šå°±åƒæ¨ç‰¹æˆ–è€…ä¸€æ¡è¯´è¯´ã€‚è¿™æ¬¡æŒ‘ä¸ªè¯´ä¸­æ–‡çš„â€œMulin Hongâ€ã€‚

```python
USER_ID = '102121409478764742904' # Mulin Hong
service = apiclient.discovery.build('plus', 'v1', http=httplib2.Http(), developerKey=API_KEY)
activity_feed = service.activities().list(
  userId=USER_ID,
  collection='public',
  maxResults='100' # æœ€å¤§å…è®¸è®°å½•æ¡æ•°
).execute()
print (json.dumps(activity_feed, ensure_ascii=False,indent=2))
```

service.activities().listæ–¹æ³•æœ‰å‡ ä¸ªå¿…è¦å‚æ•°ï¼ŒuserId:æ´»åŠ¨å‘èµ·è€…Idã€‚å¯é€‰å‚æ•°ï¼šcollection:æ´»åŠ¨å½’å±çš„é›†,é»˜è®¤ä¸ºpublicï¼Œè¿˜æ˜¯çœ‹ä¸‹é¢å›¾ç‰‡å§ï¼š

![](http://oc5ofszxe.bkt.clouddn.com/16-10-17/84664354.jpg)

å…¶ä»–å‚æ•°å¯ä»¥é€šè¿‡å‘½ä»¤*help(service.activities().list)*æ¥æŸ¥çœ‹ã€‚
ç”±äºå…±7000å¤šè¡Œï¼Œä¸æ–¹ä¾¿ç›´æ¥æ”¾å…¥æ–‡ç« ï¼Œå¯ä»¥ç‚¹å‡»æŸ¥çœ‹å†…å®¹ã€‚

å¦‚æœä»”ç»†è§‚å¯Ÿå†…å®¹ï¼Œä½ ä¼šå‘ç°contentä¸­æœ‰è®¸å¤šhtmlæ ‡ç­¾ï¼Œåƒ\<br\>ä¹‹ç±»çš„åœ¨æ–‡æœ¬ä¸­åº”è¯¥å»é™¤ï¼Œè¿™é‡Œç”¨åˆ°python Beautifulsoup4åŒ…[^1],(Beautiful Soup)å·²æˆä¸ºå’Œlxmlã€html6libä¸€æ ·å‡ºè‰²çš„pythonè§£é‡Šå™¨ï¼Œä¸ºç”¨æˆ·çµæ´»åœ°æä¾›ä¸åŒçš„è§£æç­–ç•¥æˆ–å¼ºåŠ²çš„é€Ÿåº¦ï¼Œæä¾›ä¸€äº›ç®€å•çš„ã€pythonå¼çš„å‡½æ•°ç”¨æ¥å¤„ç†å¯¼èˆªã€æœç´¢ã€ä¿®æ”¹åˆ†ææ ‘ç­‰åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªå·¥å…·ç®±ï¼Œé€šè¿‡è§£ææ–‡æ¡£ä¸ºç”¨æˆ·æä¾›éœ€è¦æŠ“å–çš„æ•°æ®ï¼Œå› ä¸ºç®€å•ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤šå°‘ä»£ç å°±å¯ä»¥å†™å‡ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç¨‹åºã€‚ç®€å•æ¥è¯´ï¼ŒBeautiful Soupæ˜¯pythonçš„ä¸€ä¸ªåº“ï¼Œæœ€ä¸»è¦çš„åŠŸèƒ½æ˜¯ä»ç½‘é¡µæŠ“å–æ•°æ®ã€‚æ›´å¤šå…³äºBeautiful Soupçš„å†…å®¹å¯ä»¥å‚è§å­¦ä¹ æ•™ç¨‹[^2]ã€‚

éšä¾¿æ‹¿æ¡å†…å®¹:
![](http://oc5ofszxe.bkt.clouddn.com/16-10-18/58368208.jpg)
å¯ä»¥å‘ç°é‡Œé¢é™¤äº†å«æœ‰htmlæ ‡ç­¾è¿˜æœ‰BOMå­—ç¬¦(\ufeff)ï¼Œä½¿ç”¨bs4å»é™¤ï¼š
![](http://oc5ofszxe.bkt.clouddn.com/16-10-18/17333322.jpg)

æˆ‘ä»¬ä¸Šé¢åªæ‹¿äº†100æ¡è®°å½•ï¼Œèƒ½ä¸èƒ½æ‹¿å…¨éƒ¨è®°å½•å‘¢ï¼Ÿæˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹çˆ¬ä¸‹çš„jsonæ–‡ä»¶ï¼Œå‘ç°ç¬¬ä¸€è¡Œæ˜¾ç¤ºnextPageTokenï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æœ‰ä¸‹ä¸€é¡µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡service.activities().list_nextæ–¹æ³•æ‹¿åˆ°ä¸‹ä¸€é¡µçš„resopnseã€‚æœ€åæˆ‘ä»¬æ‹¿åˆ°æ‰€æœ‰jsonå¹¶ç”¨ä¸Šé¢æ–¹æ³•æ¸…æ´—æ•´ç†ã€‚

```python
import os
import httplib2
import json
import apiclient.discovery
from bs4 import BeautifulSoup

USER_ID = '102121409478764742904' # Mulin Hong
MAX_RESULTS = 400 # æœ€å¤§çºªå½•æ•°ï¼Œæ¯é¡µ100æ¡ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤š5é¡µï¼ˆ0~4é¡µï¼‰
API_KEY = 'ä½ è‡ªå·±çš„api_key' 

def cleanHtml(html):
  if html == "": return ""
  return BeautifulSoup(html,'lxml').get_text()[:-1]

service = apiclient.discovery.build('plus', 'v1', http=httplib2.Http(), 
                                    developerKey=API_KEY)
activity_feed = service.activities().list(userId=USER_ID,
  collection='public',
  maxResults='100' 
)

activity_results = []

while activity_feed != None and len(activity_results) < MAX_RESULTS:
  activities = activity_feed.execute()
  if 'items' in activities:
    for activity in activities['items']:
      if activity['object']['objectType'] == 'note' and activity['object']['content'] != '':        
        activity['title'] = cleanHtml(activity['title'])
        activity['object']['content'] = cleanHtml(activity['object']['content'])
        activity_results += [activity]
#æŸ¥çœ‹ä¸‹ä¸€é¡µ
  activity_feed = service.activities().list_next(activity_feed, activities)
# å†™åˆ°ä¸€ä¸ªjsonæ–‡ä»¶ä¸­å»
f = open(os.path.join('resources', USER_ID + '.json'), 'w')
f.write(json.dumps(activity_results,ensure_ascii=False, indent=2))
f.close()
print (str(len(activity_results)), "activities written to", f.name)
```
æœ€åè¾“å‡ºç»“æœ"422 activities written to resources/102121409478764742904.json"ï¼Œå…±422æ¡è¢«è¾“å‡ºã€‚[æŸ¥çœ‹](/html/102121409478764742904.json)

## ä¸­æ–‡åˆ†è¯
ä¸ºäº†è¿›ä¸€æ­¥å¯¹æ¯æ¡è®°å½•åˆ†æï¼Œæœ‰å¿…è¦è¿›è¡Œä¸­æ–‡åˆ†è¯ã€‚æ–‡ç« [^3]ä¸­æåˆ°11æ¬¾å¼€æ”¾ä¸­æ–‡åˆ†è¯å¼•æ“ï¼Œä»åˆ†è¯æ•ˆæœå’Œè°ƒç”¨éš¾åº¦è§’åº¦è€ƒè™‘ï¼Œè¿™é‡Œé‡‡ç”¨å•†ä¸šåŒ–çš„BosonNLPå·¥å…·ï¼ˆå…³é”®è¢«ä»–ä¸€å¥å¹¿å‘Šå¸å¼•â€œç°åœ¨åŠ å…¥BosonNLPï¼Œå¯è·å¾—åˆ†è¯ä¸è¯æ€§æ ‡æ³¨å¼•æ“ä¸é™é‡è°ƒç”¨é¢åº¦ï¼â€ï¼‰ã€‚
æ³¨å†Œ[æ³¢æ£®](http://bosonnlp.com/)åä¼šç»™ä½ ä¸€ä¸ªapi_keyï¼Œå’Œgoogle+ä¸€ä¸ªåŸç†ã€‚å®‰è£…pythonç‰ˆSDKï¼š pip install -U bosonnlp
ã€‚[apiæ–‡æ¡£](http://bosonnlp-py.readthedocs.io/#bosonnlp)å¾ˆç®€å•ï¼Œçœ‹ä¸€éå°±ç›´æ¥ç”¨äº†ã€‚

å¼•ç”¨æ–¹æ³•ï¼š

```
In [1]: from bosonnlp import BosonNLP

In [2]: nlp = BosonNLP('ä½ è‡ªå·±çš„api_key')

In [3]: s='å½“å¹´åŒ—äº¬å¸‚é•¿å¤¸ä¸‹æµ·å£ï¼š 2017å¹´æ²»ä¸äº†é›¾éœ¾å°±æå¤´æ¥è§      2016å¹´10æœˆ16æ—¥ï¼ŒåŒ—äº¬å¸‚ç©ºæ°”æ±¡æŸ“æŒ‡æ•°è¯»æ•°    å—¯ï¼Œ
   ...: åŒ—äº¬å¸‚é•¿åŒå¿—ï¼Œä½ åªæœ‰ä¸¤ä¸ªå¤šæœˆçš„æ—¶é—´äº†â€¦â€¦'

In [4]: nlp.tag(s)[0]['word']
Out[6]:
['å½“å¹´',
 'åŒ—äº¬',
 'å¸‚é•¿',
 'å¤¸',
 'ä¸‹',
 'æµ·å£',
 'ï¼š',
 '2017å¹´',
 'æ²»',
 'ä¸',
 'äº†',
 'é›¾éœ¾',
 ...
```
ç›´æ¥ä½¿ç”¨é‡Œé¢çš„apiè¿›è¡Œæƒ…æ„Ÿåˆ†æï¼š

```python
from bosonnlp import BosonNLP
nlp = BosonNLP('ä½ çš„api_key')
all_content = [a['object']['content'] for a in activity_results ]
emos=nlp.sentiment(all_content[:100], model='weibo')#å•è¯æœ€å¤šåªèƒ½åˆ†æ100ä¸ªï¼Œæ¯æ—¥æœ€å¤š500ä¸ª
drawdata=list(zip(*emos))[0]
```
ç»˜åˆ¶ç®±çº¿å›¾å’Œç»Ÿè®¡ç›´æ–¹å›¾ï¼š

![](http://oc5ofszxe.bkt.clouddn.com/16-10-18/23871192.jpg)

![](http://oc5ofszxe.bkt.clouddn.com/16-10-18/94976039.jpg)

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ•´ä½“æƒ…æ„Ÿåä¸Šï¼Œè¿™é‡Œåªè®¡ç®—äº†100æ¡ï¼Œæœ‰å…´è¶£æŠŠä¸€å¤©çš„å…è´¹è®°å½•æ•°500æ¡å…¨è®¡ç®—å®Œäº†çœ‹çœ‹ç»“æœã€‚å½“ç„¶æƒ…æ„Ÿç®—æ³•ç”¨çš„å¾ˆæ™®éäº†ï¼Œè‡ªå·±å®ç°ä¸ªä¹Ÿééš¾äº‹ã€‚
hrKOofx5.10057.yUUmemEd43Dm
## NLTK
æ–¯å¦ç¦å¤§å­¦è‡ªç„¶è¯­è¨€å¤„ç†ç»„æ˜¯ä¸–ç•ŒçŸ¥åçš„NLPç ”ç©¶å°ç»„ï¼Œä»–ä»¬æä¾›äº†ä¸€ç³»åˆ—å¼€æºçš„Javaæ–‡æœ¬åˆ†æå·¥å…·ï¼ŒåŒ…æ‹¬åˆ†è¯å™¨(Word Segmenter)ï¼Œè¯æ€§æ ‡æ³¨å·¥å…·ï¼ˆPart-Of-Speech Taggerï¼‰ï¼Œå‘½åå®ä½“è¯†åˆ«å·¥å…·ï¼ˆNamed Entity Recognizerï¼‰ï¼Œå¥æ³•åˆ†æå™¨ï¼ˆParserï¼‰ç­‰ï¼Œå¯å–œçš„äº‹ï¼Œä»–ä»¬è¿˜ä¸ºè¿™äº›å·¥å…·è®­ç»ƒäº†ç›¸åº”çš„ä¸­æ–‡æ¨¡å‹ï¼Œæ”¯æŒä¸­æ–‡æ–‡æœ¬å¤„ç†ã€‚NLTK[^4]æ˜¯é’ˆå¯¹pythonçš„ä¸€ä¸ªè‡ªç„¶è¯­è¨€å¤„ç†å¹³å°,åœ¨windowsã€macã€linuxå¹³å°ä¸Šé€šç”¨ï¼Œå¹¶ä¸”æ˜¯å¼€æºå…è´¹çš„ï¼Œå›½å†…å¥½å¤šé¡¹ç›®éƒ½æ˜¯åœ¨å®ƒåŸºç¡€ä¸Šåšçš„ã€‚
ä¸‹é¢ç”¨nltkåˆ†æä¸‹æŠ“åˆ°çš„æ•°æ®ã€‚

```python
import nltk
from bosonnlp import BosonNLP

nlp = BosonNLP('ä½ è‡ªå·±çš„api_key')

#å°†æ‰€æœ‰è®°å½•è½¬åŒ–ä¸ºä¸€ä¸ªè¯è¯­æ•°ç»„tokens
contents='ã€‚'.join(all_content)
tokens=nlp.tag(contents)[0]['word']
text = nltk.Text(tokens)

text.concordance("ä¸‰æ˜Ÿ")#æŸ¥çœ‹å‡ºç°â€˜ä¸‰æ˜Ÿâ€™çš„è¯­å¥,å¯é€‰å‚æ•°åŒ…æ‹¬è¯­å¥æ•°ç›®å’Œè¯­å¥é•¿åº¦
'''
Displaying 4 of 4 matches:
 åŒ—äº¬ å¸‚é•¿ å‡†å¤‡ å¦‚ä½• æ”¶åœº ï¼Ÿ ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 1016 ï¼š ä¸‰æ˜Ÿ æ‰‹æœº åä¸è™šä¼  ã€‚ How to mess up # StarWars a
å‡ è®ºæ–‡ ï¼Œ é‚£ å°± æ˜¯ ä¸¢è„¸ äº† ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 0923 ï¼š ä¸‰æ˜Ÿ ä¸€ç”Ÿ é»‘ http://cinacn.blogspot.com/2016/
 ï¼š å¿ƒé‡Œ æƒ³ è¯´ æ²¡äº‹ äº† ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 0917 ï¼š ä½¿ç”¨ ä¸‰æ˜Ÿ æ‰‹æœº çš„ åæœ ã€‚ è¿™ä¸ª é”™è¯¯ æœ‰ç‚¹ å¤§ äº† ã€‚ çœ‹çœ‹ æœé²œ æˆ˜äº‰ å¤§äº‹è®°
 ä½ ä»¬ å¼€å­¦ ä¸€æ¬¡æ€§ äº¤ å¤šå°‘ é’± ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 0906 ï¼š ä¸‰æ˜Ÿ æ‰‹æœº çš„ ä¸­ä¸œ ç‰ˆ ã€‚ èˆ†æƒ… ç›‘æ§ ï¼Œ å·²ç» æ˜¯ å¤§é™† åª’ç•Œ ä¸ç”¨ å…¬å¼€ 
'''
text.collocations()#æœ€æ­é…çš„ç”¨è¯
'''
Displaying 4 of 4 matches:
 åŒ—äº¬ å¸‚é•¿ å‡†å¤‡ å¦‚ä½• æ”¶åœº ï¼Ÿ ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 1016 ï¼š ä¸‰æ˜Ÿ æ‰‹æœº åä¸è™šä¼  ã€‚ How to mess up # StarWars a
å‡ è®ºæ–‡ ï¼Œ é‚£ å°± æ˜¯ ä¸¢è„¸ äº† ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 0923 ï¼š ä¸‰æ˜Ÿ ä¸€ç”Ÿ é»‘ http://cinacn.blogspot.com/2016/
 ï¼š å¿ƒé‡Œ æƒ³ è¯´ æ²¡äº‹ äº† ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 0917 ï¼š ä½¿ç”¨ ä¸‰æ˜Ÿ æ‰‹æœº çš„ åæœ ã€‚ è¿™ä¸ª é”™è¯¯ æœ‰ç‚¹ å¤§ äº† ã€‚ çœ‹çœ‹ æœé²œ æˆ˜äº‰ å¤§äº‹è®°
 ä½ ä»¬ å¼€å­¦ ä¸€æ¬¡æ€§ äº¤ å¤šå°‘ é’± ã€‚ # çœ‹ å›¾ ä¸ è¯´è¯ 0906 ï¼š ä¸‰æ˜Ÿ æ‰‹æœº çš„ ä¸­ä¸œ ç‰ˆ ã€‚ èˆ†æƒ… ç›‘æ§ ï¼Œ å·²ç» æ˜¯ å¤§é™† åª’ç•Œ ä¸ç”¨ å…¬å¼€ 
'''
text.collocations()#æœ€æ­é…çš„ç”¨è¯
'''
@Homebaby Wen; little pink; sounds cute; æ ¸åºŸæ–™ å¤„ç†å‚; è¯ºè´å°” æ–‡å­¦å¥–; è¿äº‘æ¸¯ æ ¸åºŸæ–™;
åˆ›ä¸šè€… è¶Šæ¥è¶Š
'''
fdist = text.vocab()#{è¯1ï¼šè¯1å‡ºç°çš„ä¸ªæ•°ï¼Œè¯2ï¼šè¯2å‡ºç°çš„ä¸ªæ•°ï¼Œ...}
print(fdist["å¤§é™†"])
print(fdist["è€ç™¾å§“"])
print(fdist["çš„"])
print(fdist["ä¸"])
'''
25
27
1250
351
'''
print(len(tokens)) #æ€»å…±çš„è¯æ•°
print(len(fdist.keys())) #ä¸é‡å¤è¯
print(fdist.freq('çš„'))#1250/27232
print(fdist.most_common(20))# å‡ºç°æ¬¡æ•°æœ€å¤§çš„å‰20ä¸ª
'''
27232
6465
0.04590188014101058
[('ï¼Œ', 1651), ('çš„', 1250), ('ã€‚', 959), ('ï¼š', 568), ('æ˜¯', 495), ('äº†', 380), ('ä¸', 351), ('â€', 257), ('â€œ', 255), ('#', 242), ('ä¸€', 222), ('å°±', 207), ('åœ¨', 200), ('æœ‰', 162), ('ï¼Ÿ', 150), ('ä½ ', 130), ('æˆ‘', 129), ('è¿™', 129), ('äºº', 127), ('éƒ½', 124)]
'''
nltk.download('stopwords')
'''
[nltk_data] Downloading package stopwords to /Users/Trucy/nltk_data...
[nltk_data]   Unzipping corpora/stopwords.zip.
ç„¶ååœ¨è§£å‹çš„åœè¯ç›®å½•ä¸­æ·»åŠ chinaæ–‡ä»¶ï¼Œé‡Œé¢æ·»åŠ åœè¯ï¼Œè¿™é‡Œç”¨çš„å“ˆå·¥å¤§åœè¯åº“
'''
comm=list(zip(*fdist.most_common(100)))[0]#100ä¸ªçƒ­è¯ä¸­éåœè¯
print([w for w in comm if w not in nltk.corpus.stopwords.words('china')])
'''
['ä¸­å›½', 'è¯´', 'å›½å®¶', 'æ¯›', 'å¾®', 'è¯­å½•', 'ç²¾é€‰', 'å›¾', 'è¯´è¯', 'ä¸­å…±', 'æ—¥', 'æ”¿åºœ', 'å¹´', 'çˆ±å›½', 'ç¾å›½', 'å¤©', 'é’±', 'èŸèƒ', 'æ®µå­', 'é‡Œ', 'æƒ³']
'''
# éurlçš„é•¿è¯è¯­
print([w for w in fdist.keys() if len(w) > 12 and not w.startswith("http")])
'''
['@jianshenbiao', '@Jackstraw_PRC', '@Andrew19751110', '@boattractor_cj', '@_markhortonæå¾—åè€…ä¸å¾—ä¸', '@Weaponmagazine-è‚–å®ï¼‰', '@YE5MQ5Vtp2jlWX7', '@Menghuanlangqi2', '@szstupidcool', '@zhifangnvren', 'HappyBirthday', '@freedomandlaw', '@_mackhortonç»“æœæ”»å‡»äº†ä¸€ä¸ªå­—æ¯ä¹‹å·®çš„æ— è¾œé¬¼ä½¬', '@å’Œèœå¤´ï¼‰â€”â€”ä¸­å›½äººèƒ½æ¥å—ä¹ˆï¼Ÿä¸æ¯«æ²¡æœ‰å¯¹ä»–å›½çš„å°Šé‡', '@BattlerHenry', '@c338ki_selina', '@shangguanluan', '@zhanghui8964', '@fedsneighbor']
'''
```
ç›¸ä¿¡ä½ è‚¯å®šå¬è¿‡äºŒå…«åŸåˆ™ï¼Œå¦‚æœæŠŠæ‰€æœ‰çš„å•è¯ï¼ˆå­—ï¼‰æ”¾åœ¨ä¸€èµ·çœ‹å‘¢ï¼Ÿä¼šä¸ä¼š20%çš„è¯ï¼ˆå­—ï¼‰å äº†80%çš„å‡ºç°æ¬¡æ•°ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚

æ—©åœ¨ä¸Šä¸ªä¸–çºª30å¹´ä»£ï¼Œå°±æœ‰äººï¼ˆZipfï¼‰å¯¹æ­¤ä½œå‡ºäº†ç ”ç©¶ï¼Œå¹¶ç»™å‡ºäº†é‡åŒ–çš„è¡¨è¾¾â€”â€”é½æ™®å¤«å®šå¾‹ï¼ˆZipf's Lawï¼‰ï¼šä¸€ä¸ªè¯åœ¨ä¸€ä¸ªæœ‰ç›¸å½“é•¿åº¦çš„è¯­ç¯‡ä¸­çš„ç­‰çº§åºå·ï¼ˆè¯¥è¯åœ¨æŒ‰å‡ºç°æ¬¡æ•°æ’åˆ—çš„è¯è¡¨ä¸­çš„ä½ç½®ï¼Œä»–ç§°ä¹‹ä¸ºrankï¼Œç®€ç§°rï¼‰ä¸è¯¥è¯çš„å‡ºç°æ¬¡æ•°ï¼ˆä»–ç§°ä¸ºfrequencyï¼Œç®€ç§°fï¼‰çš„ä¹˜ç§¯å‡ ä¹æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼ˆconstantï¼Œç®€ç§°Cï¼‰ã€‚ç”¨å…¬å¼è¡¨ç¤ºï¼Œå°±æ˜¯ r Ã— f = C ã€‚ï¼ˆæ­¤å¤„çš„Cä¸€èˆ¬è®¤ä¸ºå–0.1ï¼‰ã€‚Zipfå®šå¾‹æ˜¯æ–‡çŒ®è®¡é‡å­¦çš„é‡è¦å®šå¾‹ä¹‹ä¸€ï¼Œå®ƒå’Œæ´›ç‰¹å¡å®šå¾‹ã€å¸ƒæ‹‰å¾·ç¦å®šå¾‹ä¸€èµ·è¢«å¹¶ç§°ä¸ºæ–‡çŒ®è®¡é‡å­¦çš„ä¸‰å¤§å®šå¾‹ã€‚

æˆ‘ä»¬ç›´è§‚åœ°éªŒè¯ä¸‹ï¼Œ100ä¸ªçƒ­è¯é¢‘åº¦å’Œæ’åçš„è§„å¾‹ï¼š

```python
#å‰100çƒ­è¯ç»Ÿè®¡
comm=list(zip(*fdist.most_common(400)))
top=[(w,comm[1][i]) for i,w in enumerate(comm[0]) \
if w not in nltk.corpus.stopwords.words('china')]
dd=list(zip(*top[:100]))
plt.plot(range(1,101),dd[1],'-',linewidth=5,alpha=0.6)
plt.xticks(arange(1,101,2),dd[0][::2],rotation=90)
plt.xlabel('å‰100çƒ­è¯',fontsize='x-large')
plt.ylabel('é¢‘æ•°',fontsize='x-large')
plt.title('å‰100çƒ­è¯ç»Ÿè®¡',fontsize='x-large')
plt.show()
```
![](http://oc5ofszxe.bkt.clouddn.com/16-10-18/30574312.jpg)

å¾ˆæ˜æ˜¾å¦‚æœå»æ‹Ÿåˆçš„è¯æ˜¯åæ¯”ä¾‹æ›²çº¿ï¼Œæœ‰å…´è¶£çš„ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆä¸‹ï¼Œçœ‹ä¸‹cç­‰äºå¤šå°‘ã€‚åŒæ ·å¯ä»¥çœ‹åˆ°ï¼Œçƒ­è¯ä¸­æ¶‰åŠæ”¿æ²»è¯æ±‡æ¯”è¾ƒå¤šï¼Œå®é™…ä¸Šå¥½å¤šä¸­æ–‡è¯´è¯´éƒ½æ¶‰åŠæ•æ„Ÿè¯æ±‡ï¼Œè¿™å·²ç»æ˜¯æˆ‘æŒ‘çš„ä¸æ€ä¹ˆæ•æ„Ÿçš„äº†ï¼Œä¸‡æ¶è…æœ½çš„google+ï¼Œå¤©æœæ—©æ™šå–ç¼”ä½ ğŸ˜ã€‚
## ç‰¹å¾è¯æå–
è¿™èŠ‚ä¸»è¦ä»‹ç»TFIDFï¼Œé«˜æ‰‹ç›´æ¥è·³è¿‡ã€‚

ç‰¹å¾è¯/å…³é”®è¯æå–æœ€ç®€å•æœ€åŸºç¡€çš„å°±æ˜¯TFIDFï¼Œè®°å¾—5å¹´å‰æˆ‘åŒå­¦è®©æˆ‘å¸®åšDI-TFIDFçš„è®ºæ–‡ï¼Œä¹Ÿå°±åªå¤šäº†ä¸ªç±»å†…ç¦»æ•£åº¦(DI)ï¼Œä»Šå¹´é˜¿é‡Œæ ¡æ‹›ç¬”è¯•é¢˜éƒ½æœ‰ï¼Œç”¨mapreduceå®ç°çš„ï¼Œå¾ˆæ˜¯å¹¿æ³›ã€‚å®é™…ä¸Štfidfç®—æ³•çš„å²æ•°ä¼°è®¡æ¯”æˆ‘è¿˜å¤§ï¼Œç›®å‰åº”ç”¨è¿˜æ˜¯å¾ˆå¹¿ã€‚å…¶ä»–ç‰¹å¾æå–æ–¹æ³•è¿˜æœ‰TFã€MIã€ECEã€QEMIã€IGã€ORã€GAã€SAã€PCAã€N-Gramç­‰ï¼Œå„æœ‰å¥½åï¼Œä¸ªäººå–œæ¬¢SAï¼ˆæ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼‰ã€‚

ç®€å•ä»‹ç»ä¸‹TFIDFï¼ŒTFIDFçš„ä¸»è¦æ€æƒ³æ˜¯ï¼šå¦‚æœæŸä¸ªè¯æˆ–çŸ­è¯­åœ¨ä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°çš„é¢‘ç‡TFé«˜ï¼Œå¹¶ä¸”åœ¨å…¶ä»–æ–‡ç« ä¸­å¾ˆå°‘å‡ºç°ï¼Œåˆ™è®¤ä¸ºæ­¤è¯æˆ–è€…çŸ­è¯­å…·æœ‰å¾ˆå¥½çš„ç±»åˆ«åŒºåˆ†èƒ½åŠ›ï¼Œé€‚åˆç”¨æ¥åˆ†ç±»ã€‚TFIDFå®é™…ä¸Šæ˜¯ï¼šTF * IDFï¼ŒTFè¯é¢‘(Term Frequency)ï¼ŒIDFåæ–‡æ¡£é¢‘ç‡(Inverse Document Frequency)ã€‚TFè¯é¢‘(Term Frequency)æŒ‡çš„æ˜¯æŸä¸€ä¸ªç»™å®šçš„è¯è¯­åœ¨è¯¥æ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°ï¼‰ã€‚IDFåæ–‡æ¡£é¢‘ç‡(Inverse Document Frequency)æ˜¯æŒ‡æœåŒ…å«è¯æ¡çš„æ–‡æ¡£è¶Šå°‘ï¼ŒIDFè¶Šå¤§ï¼Œåˆ™è¯´æ˜è¯æ¡å…·æœ‰å¾ˆå¥½çš„ç±»åˆ«åŒºåˆ†èƒ½åŠ›ã€‚å…¬å¼çœ‹çœ‹é˜®ä¸€å³°çš„æ–‡ç« [^5]å°±æ‡‚ã€‚

å…ˆç”¨æ³¢æ£®æ¥ç©ä¸€ä¸‹ã€‚

```python
#ç¬¬100åˆ°109æ¡è®°å½•å„å‰äº”ä¸ªå…³é”®å­—åˆ†æ
nlp.extract_keywords(all_content[100:110],top_k=5)
```

>[[[0.7099039005468386, 'æ—å¿—é¢–'],
  [0.6618791162771835, 'è¯´è¯'],
  [0.16548951440531323, 'å›¾'],
  [0.1391678971188951, 'çœŸ'],
  [0.08401698377794771, 'çœ‹']],  
 [[0.4023478548923522, 'é¢è¯•'],
  [0.37301990285926334, 'ç§‹æœˆ'],
  [0.3067035017321436, 'ç¨‹åºå‘˜'],
  [0.3039517495852464, 'æœˆé¥¼'],
  [0.30299584457854634, 'è¯­å½•']],  
 [[0.47362866866222336, 'æœé²œ'],
  [0.3352703984048265, 'å…¼å¬åˆ™æ˜'],
  [0.2612360542645001, 'å¿—æ„¿å†›'],
  [0.25878030672041646, 'æˆ˜äº‰'],
  [0.21926520954291415, 'è„¸çº¢']],  
 [[0.49721835098126743, 'æˆ˜äº‰'],
  [0.32820426275864795, 'å…±äº§å…š'],
  [0.3033420749749608, 'æœé²œ'],
  [0.22718247058147462, 'äº²åæ´¾'],
  [0.21472859448533965, 'ä¿å®¶']],  
 [[0.2454776400796074, 'è€å¤´'],
  [0.2404142762073897, 'å¯¼æ¸¸'],
  [0.18403709160053647, 'å¹³å£¤'],
  [0.1753006540352852, 'é¦–éƒ½'],
  [0.1462342959779542, 'å¦å…‹']],  
 [[0.611209874316231, 'è¯­å½•'],
  [0.47971562974594106, 'ç²¾é€‰'],
  [0.3914587127344426, 'å¥³ç”Ÿ'],
  [0.32629224154255926, 'å¤æ‚'],
  [0.24636184499215347, 'åˆ°åº•']],  
 [[0.49698250604754796, 'å“å§'],
  [0.41302611057797883, 'è€ç™¾å§“'],
  [0.34093105823385067, 'å¤ªç›‘'],
  [0.3321228504052302, 'å¤§é™†'],
  [0.2893273489670021, 'ç¨è´Ÿ']],  
 [[0.40325177993397743, 'å¯¼æ¸¸'],
  [0.3096728358372618, 'éŸ©æˆ˜'],
  [0.2929205806460173, 'æ¸¸å®¢'],
  [0.2480119777270853, 'å¸¦åŠ²'],
  [0.22704285072733602, 'è‡ªä»¥ä¸ºæ˜¯']],  
 [[0.7242722832662252, 'å“¥ä»¬å„¿'],
  [0.5061338668467491, 'ç€æ€¥'],
  [0.4404639544540359, 'è¯´è¯'],
  [0.11012912198474084, 'å›¾'],
  [0.07352170001676955, 'å¤ª']],  
 [[0.39101364028081176, 'é¸¦ç‰‡'],
  [0.27683827573410325, 'ç§æ¤'],
  [0.22542041392575338, 'zhuo'],
  [0.22542041392575338, 'nanjun'],
  [0.22461629498500293, 'ç¼©å¤´']]]

ç”¨tfidfæ¥åšä¸€ä¸‹ï¼Œåˆ†å››æ­¥èµ°ï¼š

1. åˆ†è¯
2. å»åœè¯
3. è®¡ç®—tfidf
4. æ’åºï¼ŒtopK

```python
cts=[]
#1.åæ¡è®°å½•çš„åˆ†è¯
for c in nlp.tag(all_content[100:110]):
    cts.append(c['word'])
tfidfC=[]
#2.å»åœè¯
for ac in cts: 
    tfidfC.append([w for w in ac 
                   if w not in nltk.corpus.stopwords.words('china')])
tc = nltk.TextCollection(tfidfC)
tfidfR=[]
topK=5
#3.è®¡ç®—tfidf
for c in tfidfC:
    res=[]
    for sc in list(set(c)):
        val=tc.tf_idf(sc,c)
        res.append([val,sc])
    #4.topK
    sres=sorted(res, key=lambda p: p[0], reverse=True)[:topK]
    tfidfR.append(sres)
print(tfidfR)
```
ç»“æœ:

>[[[0.4605170185988092, 'æ—å¿—é¢–'],
  [0.3218875824868201, 'è¯´è¯'],
  [0.3218875824868201, 'çœŸ'],
  [0.3218875824868201, '0913'],
  [0.3218875824868201, 'å›¾']],  
 [[0.24237737820989955, 'é¢è¯•'],
  [0.24237737820989955, 'å®˜'],
  [0.12118868910494977, 'ä»å‰'],
  [0.12118868910494977, 'ç§‹æœˆ'],
  [0.12118868910494977, 'åŸå› ']],  
 [[0.1485538769673578, 'ä¸­'],
  [0.11651349719283252, 'æœé²œ'],
  [0.07767566479522169, 'æˆ˜äº‰'],
  [0.0742769384836789, 'è´¡çŒ®'],
  [0.0742769384836789, 'è¯']],  
 [[0.15703993099903515, 'æˆ˜äº‰'],
  [0.10496334211526741, 'å…±äº§å…š'],
  [0.1001123953475672, 'åœº'],
  [0.07851996549951758, 'æœé²œ'],
  [0.0500561976737836, 'è¯¾æœ¬']],  
 [[0.03868841135658895, 'è¯´'],
  [0.033210361918183356, 'å¥åº·'],
  [0.033210361918183356, 'è€å¤´'],
  [0.033210361918183356, 'é¦–éƒ½'],
  [0.03095072908527116, 'æŠ¢']],  
 [[0.3837641821656743, 'å…³ç³»'],
  [0.3837641821656743, '0912'],
  [0.3837641821656743, 'å¥³ç”Ÿ'],
  [0.26823965207235, 'å¾®'],
  [0.26823965207235, 'ç²¾é€‰']],
 [[0.14631253749400913, 'å¤§é™†'],
  [0.14631253749400913, 'è€ç™¾å§“'],
  [0.10466295877245664, 'æ€»å¾—'],
  [0.10466295877245664, 'å€’æ•°'],
  [0.10466295877245664, 'æ¯›']],  
 [[0.10233711524417982, 'æƒ³'],
  [0.07153057388596001, 'å¯¼æ¸¸'],
  [0.07153057388596001, 'è¯´'],
  [0.07153057388596001, 'æ¸¸å®¢'],
  [0.07153057388596001, 'å¹´']],  
 [[0.3837641821656743, 'ç€æ€¥'],
  [0.3837641821656743, 'å“¥ä»¬å„¿'],
  [0.3837641821656743, '0911'],
  [0.26823965207235, 'è¯´è¯'],
  [0.26823965207235, 'å›¾']],  
 [[0.1151292546497023, 'é¸¦ç‰‡'],
  [0.1151292546497023, 'ç§æ¤'],
  [0.05756462732485115, 'zhuo'],
  [0.05756462732485115, 'è¡¥ä¹ '],
  [0.05756462732485115, 'å……å½“']]]
  
  ä¸¤è€…æ¯”è¾ƒä¸‹æ³¢æ£®è¦ç¨å¥½ä¸€äº›ï¼Œåº•å±‚ä¼°è®¡æ˜¯æ”¹è¿›çš„tfidfã€‚
  
## æ–‡æœ¬ç›¸ä¼¼åº¦
 æˆ‘ä»¬çœ‹ä»Šæ—¥å¤´æ¡æ–°é—»ï¼Œçœ‹å®Œåä¸‹é¢ä¼šæœ‰æ¨èç›¸ä¼¼çš„æ–‡ç« ï¼Œæä¾›ä½ æ›´å¤šé˜…è¯»çš„æœºä¼šã€‚ç›¸ä¼¼æ–‡æœ¬æ¨èæœ€åŸºæœ¬çš„æ–¹æ³•ç”¨åˆ°"[ä½™å¼¦ç›¸ä¼¼æ€§](https://en.wikipedia.org/wiki/Cosine_similarity)"ï¼ˆcosine similiarityï¼‰ã€‚ä¸¾ä¸ªç®€å•ä¾‹å­ï¼š
 ä¸¤ä¸ªæ–‡æœ¬ï¼Œå…ˆåˆ†è¯ï¼š
 >æ–‡æœ¬1ï¼šgoogle/å’Œ/ç™¾åº¦/ç›¸ä¼¼  
 >æ–‡æœ¬2ï¼šç™¾åº¦/æ¯”ä¸äº†/è°·æ­Œ
 
 è®¡ç®—è¯é¢‘
 >æ–‡æœ¬1ï¼šgoogle:1,å’Œ:1,ç™¾åº¦:1,ç›¸ä¼¼:1  
 >æ–‡æœ¬2ï¼šç™¾åº¦:1,æ¯”ä¸äº†:1,è°·æ­Œ:1
 
 åˆ—å‡ºæ‰€æœ‰è¯ï¼ŒæŒ‰è¯é¢‘æ’åºï¼š
 
 >æ–‡æœ¬1ï¼šgoogle:1,å’Œ:1,ç™¾åº¦:1,ç›¸ä¼¼:1,æ¯”ä¸äº†:0  
 >æ–‡æœ¬2ï¼šgoogle:1,å’Œ:0,ç™¾åº¦:1,ç›¸ä¼¼:0,æ¯”ä¸äº†:1 
 
 æå–è¯é¢‘å‘é‡ï¼š
 
 >æ–‡æœ¬1ï¼š[1,1,1,1,0]
 >æ–‡æœ¬2ï¼š[1,0,1,0,1]
 
 æ¥ä¸‹æ¥è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦:
 
$$CosineDistance(u, v)=\frac{u\cdot v}{|u||v|}$$

è¿™ä¸ªå…¬å¼ä»£è¡¨ä¸¤ä¸ªå‘é‡çš„å¤¹è§’ï¼ŒäºŒç»´å‘é‡å¤¹è§’é«˜ä¸­ä¸å°±æ˜¯è¿™ä¸ªå…¬å¼ä¹ˆï¼Œæ¨å¹¿åˆ°ä¸‰ç»´ç”šè‡³å¤šç»´ä¹Ÿä¸€æ ·ã€‚
![](http://oc5ofszxe.bkt.clouddn.com/16-10-19/6547011.jpg)
 
ä½™å¼¦å€¼è¶Šæ¥è¿‘1ï¼Œå°±è¡¨æ˜å¤¹è§’è¶Šæ¥è¿‘0åº¦ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå‘é‡è¶Šç›¸ä¼¼ï¼Œè¿™å°±å«"ä½™å¼¦ç›¸ä¼¼æ€§"ã€‚æ‰€ä»¥ä¸Šé¢ä¸¤æ–‡æœ¬ç›¸ä¼¼åº¦ä¸º:

$$\frac{2}{\sqrt{1^2+1^2+1^2+1^2+0^2}\times \sqrt{1^2+0^2+1^2+0^2+1^2}}=\frac{\sqrt{3}}{3}$$

ä¸‹é¢æˆ‘ä»¬æ¥ç»Ÿè®¡ä¸‹å†…å®¹è¾ƒé•¿çš„è®°å½•ç›¸ä¼¼æ–‡æœ¬(å†…å®¹è¾ƒçŸ­ç›¸ä¼¼åº¦ä¸æ˜æ˜¾)ã€‚
ç¬¬ä¸€æ­¥ï¼šæ‰¾å‡ºå†…å®¹é•¿åº¦å¤§äº700çš„è®°å½•ï¼Œå¹¶åšå¥½åˆ†è¯å’Œåœè¯

```python
#ç­›é€‰è¦æ¯”è¾ƒçš„æ–‡æœ¬æ•°æ®,å…±24æ¡è®°å½•
data=[]#ä¿å­˜object.contentå†…å®¹å¤§äº700çš„æ‰€æœ‰æ•°æ®
all_posts=[]#åªä¿ç•™å‘å¸ƒçš„å†…å®¹æ•°æ®
for ac in activity_results:
    if len(ac['object']['content'])>700:
        c=ac['object']['content']
        data.append(ac)
        #åˆ†è¯å’Œåœè¯
        all_posts.append([w for w in nlp.tag(c)[0]['word'] if w not in nltk.corpus.stopwords.words('china')])
```
ç¬¬äºŒæ­¥ï¼šæ„é€ è¯æ¡æ–‡æ¡£çŸ©é˜µã€‚å½¢å¼å¦‚$td\_matrix=\{(title_i,url_i):\{term_j:tfidf_j,...\},...\}$

```python
tc = nltk.TextCollection(all_posts)
#æ„é€ è¯æ¡æ–‡æ¡£çŸ©é˜µ
td_matrix = {}
for idx in range(len(all_posts)):
    post = all_posts[idx]
    fdist = nltk.FreqDist(post)

    doc_title = data[idx]['title']
    url = data[idx]['url']
    td_matrix[(doc_title, url)] = {}

    for term in fdist.keys():
        td_matrix[(doc_title, url)][term] = tc.tf_idf(term, post)
```
ç¬¬ä¸‰æ­¥:è®¡ç®—ç›¸ä¼¼åº¦  
è¿™é‡Œç”¨åˆ°nltk.cluster.util.cosine_distanceï¼Œè¿™ä¸ªå‡½æ•°è¯´æ˜å¦‚ä¸‹ï¼š
nltk.cluster.util.cosine_distance(u, v)[source]
Returns 1 minus the cosine of the angle between vectors v and u. This is equal to 1 - (u.v / |u||v|).
å¯ä»¥çœ‹åˆ°è¿”å›çš„æ˜¯1-ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œè¡¨ç¤ºçš„æ˜¯ä½™å¼¦è·ç¦»ï¼Œä¹Ÿå°±æ˜¯è¯´ä½™å¼¦è·ç¦»è¶Šå°ç›¸ä¼¼åº¦è¶Šé«˜ã€‚

```python
distances = {}
for (title1, url1) in td_matrix.keys():

    distances[(title1, url1)] = {}
    (min_dist, most_similar) = (1.0, ('', ''))

    for (title2, url2) in td_matrix.keys():

        terms1 = td_matrix[(title1, url1)].copy()
        terms2 = td_matrix[(title2, url2)].copy()

        # å¡«å……0ä½¿ä¸¤å‘é‡é•¿åº¦ç›¸åŒ
        for term1 in terms1:
            if term1 not in terms2:
                terms2[term1] = 0

        for term2 in terms2:
            if term2 not in terms1:
                terms1[term2] = 0

        # äº§ç”Ÿv1,v2å‘é‡ï¼Œå‘é‡å…ƒç´ æ˜ å°„ä¸€è‡´
        v1 = [score for (term, score) in sorted(terms1.items())]
        v2 = [score for (term, score) in sorted(terms2.items())]

        # è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
        distances[(title1, url1)][(title2, url2)] = \
            nltk.cluster.util.cosine_distance(v1, v2)

        if url1 == url2:
            continue
        # æ ‡è®°ä½™å¼¦è·ç¦»æœ€å°çš„ï¼ˆç›¸ä¼¼åº¦æœ€å¤§ï¼‰
        if distances[(title1, url1)][(title2, url2)] < min_dist:
            (min_dist, most_similar) = (distances[(title1, url1)][(title2,
                                         url2)], (title2, url2))
    
    print ("%s\n(%s) \n æœ€ç›¸ä¼¼çš„æ˜¯:\n %s\n(%s) \n ç›¸ä¼¼åº¦: %f \n ------------------------------\n"
           % (title1, url1,most_similar[0], most_similar[1], 1-min_dist))
```
æŸ¥çœ‹éƒ¨åˆ†ç»“æœï¼š

```

#ä¸€æ—¥æ®µå­èŸèƒ
2016-9-5

@kxxjï¼š æ–°æ­‡åè¯­ï¼šåŒ…å­å®½è¡£â€”â€”éœ²é¦…å„¿äº†ã€‚

@CasperYangï¼šé€šå•†å®½è¡£å·²åŠ å…¥æ•æ„Ÿè¯è±ªååˆé¤ã€‚

@szeyan1220ï¼šå®½è¡£è§£å¸¦æ–°ç™½å¨˜ã€‚è½»å…³æ˜“é“å¯»ä½³äººï¼Œ..
(https://plus.google.com/+MulinHong/posts/FJuFWhykUhU) 
 æœ€ç›¸ä¼¼çš„æ˜¯:
 #ä¸€æ—¥æ®µå­èŸèƒ
2016-9-7

@boattractor_cjï¼šâ€œåƒé¥±äº†æ²¡äº‹å¹²â€ï¼Œä»£è¡¨äº†ä¹ å¸çš„å¤–äº¤æ€è·¯ï¼Œåæ˜ äº†ä»–å¯¹æ´‹å¤·çš„äº†è§£æ°´å¹³ï¼›â€œåƒé¥­ç ¸é”…â€ä»£è¡¨äº†ä¹ å¸çš„å†…æ”¿æ€è·¯ï¼Œåæ˜ äº†ä»–è”‘è§†å±æ°‘çš„éœ¸æ°”ï¼›â€œæ‰“æ–­éª¨å¤´..
(https://plus.google.com/+MulinHong/posts/BfAsHEk3Dfs) 
 ç›¸ä¼¼åº¦: 0.018108 
 ------------------------------

#ä¸€æ—¥æ®µå­èŸèƒ
2016-8-9

@blogtdï¼šæˆ‘å¥‡æ€ªçš„æ˜¯ï¼Œä¸ç®¡ä½œä¸ºä¸€ä¸ªå›½å®¶ï¼Œè¿˜æ˜¯ä¸€ä¸ªæ—ç¾¤ï¼Œä¸­å›½ä»æœªå‘ä¸–ç•Œå±•ç°è¿‡ç¾æ„§è¿™ç§æƒ…ç»ªã€‚

@hnjhjï¼šå„ç±»è¾±åäº‹ä»¶é¢‘å‘ï¼Œä½†å› æ˜Ÿæ˜Ÿè§’åº¦ä¸å¯¹è€Œè¾±åè¿˜æ˜¯å§‹æ–™æœªåŠ..
(https://plus.google.com/+MulinHong/posts/Y4DMUPtSSTB) 
 æœ€ç›¸ä¼¼çš„æ˜¯:
 #ä¸€æ—¥æ®µå­èŸèƒ
2016-9-26

@zhanghui8964ï¼šå°±ç›®å‰å½¢æ€è€Œè¨€ï¼Œæˆ‘ä¸€ç›´ä¸è®¤ä¸ºæ¸è¿›æ”¹è‰¯æ˜¯ä¸€ç§æ”¿æ²»å­˜åœ¨ï¼Œä¹Ÿä¸è®¤ä¸ºæ¿€è¿›é©å‘½æ˜¯ä¸€ç§æ”¿æ²»å­˜åœ¨ã€‚åœ¨ä¸€å®šæ„ä¹‰ä¸Šå¤§å®¶éƒ½æ˜¯å£ç‚®å…šã€‚åŒºåˆ«åªåœ¨äºéƒ¨åˆ†åŠªåŠ›è€…æäº†..
(https://plus.google.com/+MulinHong/posts/BNqkLxd9YCP) 
 ç›¸ä¼¼åº¦: 0.026590 
 ------------------------------

#ä¸€æ—¥æ®µå­èŸèƒ
2016-8-29

@ä¾¯è™¹æ–Œï¼šè­¦åŠ›é…ç½®å§ã€‚ä¸»è¦ç²¾åŠ›æ”¾åœ¨ç»´ç¨³ä¸Šï¼Œè¿™ç±»è¯ˆéª—æ¡ˆå‡ ä¹ä¸ä¼šæŠ•å…¥è­¦åŠ›èµ„æºï¼›åˆ°å…¨ç¤¾ä¼šéƒ½å…³æ³¨äº†ï¼Œå°±å˜æˆç»´ç¨³çš„äº‹ä»¶äº†ï¼Œè­¦æ–¹é©¬ä¸Šå°±æœ‰èµ„æºå¯¹æ¥äº†ã€‚

@baiduå†·å…µå™¨å§ï¼š..
(https://plus.google.com/+MulinHong/posts/RTDgVPKvbyM) 
 æœ€ç›¸ä¼¼çš„æ˜¯:
 #ä¸€æ—¥æ®µå­èŸèƒ
2016-8-23

@MyDFï¼šæ˜¨å¤©ä¸‹åˆè·¯è¿‡æ´ªéƒ½å—å¤§é“ï¼Œå‘ç°æ²¿é€”å¢åŠ äº†ä¸å°‘äº¤è­¦ï¼Œè¯¡å¼‚çš„æ˜¯ï¼Œå¤§çƒ­å¤©çš„è¡—è¾¹è¿˜ç«™ç€æˆ–åç€ä¸å°‘å¯ç–‘çš„ç¾¤ä¼—ï¼Œå‡ å…¬é‡Œéƒ½æ˜¯ï¼Œè±¡æ˜¯åœ¨ç­‰ä»€ä¹ˆå¤§äººç‰©ã€‚ä»Šå¤©çœ‹äº†æ–°é—»ï¼Œæ‰çŸ¥é“..
(https://plus.google.com/+MulinHong/posts/UVZVyshut8R) 
 ç›¸ä¼¼åº¦: 0.082137 
 ------------------------------
```
ä¸ºæŸ¥çœ‹æ–¹ä¾¿ï¼Œç»˜åˆ¶ç›¸ä¼¼åº¦çŸ©é˜µå›¾ï¼š
![](http://oc5ofszxe.bkt.clouddn.com/16-10-19/4103503.jpg)

## REF
[^1]: python3.4å­¦ä¹ ç¬”è®°(åä¸ƒ) ç½‘ç»œçˆ¬è™«ä½¿ç”¨Beautifulsoup4æŠ“å–å†…å®¹.http://www.cnblogs.com/zdz8207/p/python_learn_note_17.html
[^2]: Beautiful Soup 4.2.0 æ–‡æ¡£.https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html
[^3]: 11 æ¬¾å¼€æ”¾ä¸­æ–‡åˆ†è¯å¼•æ“è¯„æµ‹.http://www.cnblogs.com/croso/p/5349517.html
[^4]: Natural Language Toolkit.http://www.nltk.org/index.html
[^5]: TF-IDFä¸ä½™å¼¦ç›¸ä¼¼æ€§çš„åº”ç”¨ï¼ˆä¸€ï¼‰ï¼šè‡ªåŠ¨æå–å…³é”®è¯.http://www.ruanyifeng.com/blog/2013/03/tf-idf.html
- Russell, Matthew A. Mining the Social Web: Data Mining Facebook, Twitter, LinkedIn, Google+, GitHub, and More. O'Reilly Media, Inc. 2013.
